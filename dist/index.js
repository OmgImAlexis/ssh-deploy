module.exports=function(e,t){"use strict";var r={};function __webpack_require__(t){if(r[t]){return r[t].exports}var n=r[t]={i:t,l:false,exports:{}};e[t].call(n.exports,n,n.exports,__webpack_require__);n.l=true;return n.exports}__webpack_require__.ab=__dirname+"/";function startup(){return __webpack_require__(555)}t(__webpack_require__);return startup()}({87:function(e){e.exports=require("os")},129:function(e){e.exports=require("child_process")},243:function(e,t,r){"use strict";var n=r(129).exec;var i=r(129).execSync;var o=r(747);var s=r(622);var u=o.access;var c=o.accessSync;var a=o.constants||o;var f=process.platform=="win32";var d=function(e,t){u(e,a.F_OK,function(e){t(!e)})};var l=function(e){try{c(e,a.F_OK);return false}catch(e){return true}};var p=function(e,t){u(e,a.F_OK|a.X_OK,function(e){t(null,!e)})};var v=function(e){try{c(e,a.F_OK|a.X_OK);return true}catch(e){return false}};var h=function(e,t,r){d(e,function(i){if(!i){var o=n("command -v "+t+" 2>/dev/null"+" && { echo >&1 "+t+"; exit 0; }",function(e,t,n){r(null,!!t)});return}p(e,r)})};var y=function(e,t,r){if(/[\x00-\x1f<>:"\|\?\*]/.test(e)){r(null,false);return}var i=n("where "+t,function(e){if(e!==null){r(null,false)}else{r(null,true)}})};var g=function(e,t){if(l(e)){try{var r=i("command -v "+t+" 2>/dev/null"+" && { echo >&1 "+t+"; exit 0; }");return!!r}catch(e){return false}}return v(e)};var m=function(e,t,r){if(/[\x00-\x1f<>:"\|\?\*]/.test(e)){return false}try{var n=i("where "+t,{stdio:[]});return!!n}catch(e){return false}};var _=function(e){if(/[^A-Za-z0-9_\/:=-]/.test(e)){e="'"+e.replace(/'/g,"'\\''")+"'";e=e.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")}return e};if(f){_=function(e){var t=/[\\]/.test(e);if(t){var r='"'+s.dirname(e)+'"';var n='"'+s.basename(e)+'"';return r+":"+n}return'"'+e+'"'}}e.exports=function commandExists(e,t){var r=_(e);if(!t&&typeof Promise!=="undefined"){return new Promise(function(t,r){commandExists(e,function(n,i){if(i){t(e)}else{r(n)}})})}if(f){y(e,r,t)}else{h(e,r,t)}};e.exports.sync=function(e){var t=_(e);if(f){return m(e,t)}else{return g(e,t)}}},250:function(e,t,r){"use strict";var n=r(129).spawn;var i=r(669);var o=function(e){if(typeof e==="string"){return e.replace(/\b\s/g,"\\ ")}else{return e}};var s=function(e){["src","dest","include","exclude","excludeFirst"].forEach(function(t){var r=e[t];if(typeof r==="string"){e[t]=o(r)}else if(Array.isArray(r)===true){e[t]=r.map(o)}});return e};e.exports=function(e,t){e=e||{};e=i._extend({},e);e=s(e);var r=e.platform||process.platform;var o=r==="win32";if(typeof e.src==="undefined"){throw new Error("'src' directory is missing from options")}if(typeof e.dest==="undefined"){throw new Error("'dest' directory is missing from options")}var u=e.dest;if(typeof e.host!=="undefined"){u=e.host+":"+e.dest}if(!Array.isArray(e.src)){e.src=[e.src]}var c=[].concat(e.src);c.push(u);var a=(e.args||[]).find(function(e){return e.match(/--chmod=/)});if(o&&!a){c.push("--chmod=ugo=rwX")}if(typeof e.host!=="undefined"||e.ssh){c.push("--rsh");var f="ssh";if(typeof e.port!=="undefined"){f+=" -p "+e.port}if(typeof e.privateKey!=="undefined"){f+=" -i "+e.privateKey}if(typeof e.sshCmdArgs!=="undefined"){f+=" "+e.sshCmdArgs.join(" ")}c.push(f)}if(e.recursive===true){c.push("--recursive")}if(e.times===true){c.push("--times")}if(e.syncDest===true||e.deleteAll===true){c.push("--delete");c.push("--delete-excluded")}if(e.syncDestIgnoreExcl===true||e.delete===true){c.push("--delete")}if(e.dryRun===true){c.push("--dry-run");c.push("--verbose")}if(typeof e.excludeFirst!=="undefined"&&i.isArray(e.excludeFirst)){e.excludeFirst.forEach(function(e,t){c.push("--exclude="+e)})}if(typeof e.include!=="undefined"&&i.isArray(e.include)){e.include.forEach(function(e,t){c.push("--include="+e)})}if(typeof e.exclude!=="undefined"&&i.isArray(e.exclude)){e.exclude.forEach(function(e,t){c.push("--exclude="+e)})}switch(e.compareMode){case"sizeOnly":c.push("--size-only");break;case"checksum":c.push("--checksum");break}if(typeof e.args!=="undefined"&&i.isArray(e.args)){c=[...new Set([...c,...e.args])]}c=[...new Set(c)];var d=function(){};var l=e.onStdout||d;var p=e.onStderr||d;var v="rsync ";c.forEach(function(e){if(e.substr(0,4)==="ssh "){e='"'+e+'"'}v+=e+" "});v=v.trim();if(e.noExec){t(null,null,null,v);return}try{var h="";var y="";var g;if(o){g=n("cmd.exe",["/s","/c",'"'+v+'"'],{windowsVerbatimArguments:true,stdio:[process.stdin,"pipe","pipe"]})}else{g=n("/bin/sh",["-c",v])}g.stdout.on("data",function(e){l(e);h+=e});g.stderr.on("data",function(e){p(e);y+=e});g.on("exit",function(e){var r=null;if(e!==0){r=new Error("rsync exited with code "+e);r.code=e}t(r,h,y,v)})}catch(e){t(e,null,null,v)}}},428:function(e,t,r){var n=r(129).exec;var i={get:getString,run:runCommand};function runCommand(e){return n(e)}function getString(e,t){return n(e,function(){return function(e,r,n){if(!t)return;t(e,r,n)}}(t))}e.exports=i},431:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const i=n(r(87));function issueCommand(e,t,r){const n=new Command(e,t,r);process.stdout.write(n.toString()+i.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const o="::";class Command{constructor(e,t,r){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=r}toString(){let e=o+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=true;for(const r in this.properties){if(this.properties.hasOwnProperty(r)){const n=this.properties[r];if(n){if(t){t=false}else{e+=","}e+=`${r}=${escapeProperty(n)}`}}}}e+=`${o}${escapeData(this.message)}`;return e}}function toCommandValue(e){if(e===null||e===undefined){return""}else if(typeof e==="string"||e instanceof String){return e}return JSON.stringify(e)}t.toCommandValue=toCommandValue;function escapeData(e){return toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(e){return toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},470:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){function adopt(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,i){function fulfilled(e){try{step(n.next(e))}catch(e){i(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){i(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(t,"__esModule",{value:true});const o=r(431);const s=i(r(87));const u=i(r(622));var c;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(c=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){const r=o.toCommandValue(t);process.env[e]=r;o.issueCommand("set-env",{name:e},r)}t.exportVariable=exportVariable;function setSecret(e){o.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){o.issueCommand("add-path",{},e);process.env["PATH"]=`${e}${u.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r){throw new Error(`Input required and not supplied: ${e}`)}return r.trim()}t.getInput=getInput;function setOutput(e,t){o.issueCommand("set-output",{name:e},t)}t.setOutput=setOutput;function setCommandEcho(e){o.issue("echo",e?"on":"off")}t.setCommandEcho=setCommandEcho;function setFailed(e){process.exitCode=c.Failure;error(e)}t.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}t.isDebug=isDebug;function debug(e){o.issueCommand("debug",{},e)}t.debug=debug;function error(e){o.issue("error",e instanceof Error?e.toString():e)}t.error=error;function warning(e){o.issue("warning",e instanceof Error?e.toString():e)}t.warning=warning;function info(e){process.stdout.write(e+s.EOL)}t.info=info;function startGroup(e){o.issue("group",e)}t.startGroup=startGroup;function endGroup(){o.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return n(this,void 0,void 0,function*(){startGroup(e);let r;try{r=yield t()}finally{endGroup()}return r})}t.group=group;function saveState(e,t){o.issueCommand("save-state",{name:e},t)}t.saveState=saveState;function getState(e){return process.env[`STATE_${e}`]||""}t.getState=getState},555:function(e,t,r){"use strict";r.r(t);var n=r(622);var i=r(470);const o=e=>{const t=Object.keys(e);const r=t.filter(t=>{const r=e[t];if(!r){Object(i.error)(`⚠️ [INPUTS] ${t} is mandatory.`)}return r});if(r.length!==t.length){Object(i.setFailed)(`⚠️ [INPUTS] Inputs not valid, aborting.`);process.exit()}};var s=r(669);var u=r(677);var c=r(428);var a=undefined&&undefined.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};const f=Object(s.promisify)(c.get);const d=()=>a(undefined,void 0,void 0,function*(){const e=Object(u.sync)("rsync");if(!e){yield f("sudo apt-get --no-install-recommends install rsync").catch(e=>{Object(i.setFailed)(`⚠️ [CLI] Rsync installation failed. Aborting ...\n${e.message}`);process.exit()});Object(i.info)(`✅ [CLI] Rsync installed.`)}});var l=r(747);const{GITHUB_WORKSPACE:p}=process.env;const v=e=>{if(Object(l.existsSync)(e)){Object(i.info)(`[SSH] ${e} dir exists.`);return}Object(i.info)(`[SSH] Creating ${e} dir in ${p}`);Object(l.mkdirSync)(e);Object(i.info)("✅ [SSH] dir created.")};const h=e=>{if(Object(l.existsSync)(e)){Object(i.error)(`[SSH] ${e} file exists.`);return}Object(i.info)(`[SSH] Creating ${e} file in ${p}`);try{Object(l.writeFileSync)(e,"",{encoding:"utf8",mode:384});Object(i.info)("✅ [SSH] file created.")}catch(e){Object(i.error)("⚠️ [SSH] writeFileSync error\n${filePath}\n${error.message}");process.abort()}};const{HOME:y}=process.env;const g=(e,t)=>{const r=Object(n.join)(y||__dirname,".ssh");const o=Object(n.join)(r,t);v(r);h(`${r}/known_hosts`);try{Object(l.writeFileSync)(o,e,{encoding:"utf8",mode:384})}catch(e){Object(i.error)(`⚠️ writeFileSync error\n${o}\n${e.message}`);process.abort()}Object(i.info)(`✅ Ssh key added to \`.ssh\` dir ${o}`);return o};var m=r(250);var _=r.n(m);var O=undefined&&undefined.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};const b=Object(s.promisify)(_.a);const S={ssh:true,sshCmdArgs:["-o StrictHostKeyChecking=no"],recursive:true};const x=({privateKey:e,port:t,src:r,dest:n,args:o})=>O(undefined,void 0,void 0,function*(){Object(i.info)(`[Rsync] Starting Rsync Action: ${r} to ${n}`);return b(Object.assign({src:r,dest:n,args:o,privateKey:e,port:t},S)).catch(e=>{Object(i.setFailed)("⚠️ [Rsync] command error: \n${error.message}\n${error.stack}");process.exit()})});var j=undefined&&undefined.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};const{DEPLOY_KEY_NAME:w}=process.env;const E=({src:e,dest:t,args:r,host:n="localhost",port:i,username:o,privateKeyContent:s})=>j(undefined,void 0,void 0,function*(){const u=g(s,w||"deploy_key");const c=`${o}@${n}:${t}`;yield d();yield x({privateKey:u,port:i,src:e,dest:c,args:r})});var C=undefined&&undefined.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function fulfilled(e){try{step(n.next(e))}catch(e){o(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){o(e)}}function step(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())})};const{REMOTE_HOST:P,REMOTE_USER:$,REMOTE_PORT:A,SSH_PRIVATE_KEY:R,SOURCE:T,TARGET:F,ARGS:H,GITHUB_WORKSPACE:K}=process.env;const I=()=>C(undefined,void 0,void 0,function*(){if(!K){Object(i.error)("⚠️ [general] GITHUB_WORKSPACE env is missing.");return}Object(i.info)(`[general] GITHUB_WORKSPACE: ${K}`);o({SSH_PRIVATE_KEY:R,REMOTE_HOST:P,REMOTE_USER:$});return E({src:Object(n.join)(K,T||""),dest:F||`/home/${$}/`,args:H?[H]:["-rltgoDzvO"],host:P,port:A||"22",username:$,privateKeyContent:R})});I().catch(e=>{Object(i.setFailed)(e.message)})},622:function(e){e.exports=require("path")},669:function(e){e.exports=require("util")},677:function(e,t,r){e.exports=r(243)},747:function(e){e.exports=require("fs")}},function(e){"use strict";!function(){e.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})}}();!function(){var t=Object.prototype.hasOwnProperty;e.d=function(e,r,n){if(!t.call(e,r)){Object.defineProperty(e,r,{enumerable:true,get:n})}}}();!function(){e.t=function(t,r){if(r&1)t=this(t);if(r&8)return t;if(r&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);e.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(r&2&&typeof t!="string")for(var i in t)e.d(n,i,function(e){return t[e]}.bind(null,i));return n}}();!function(){e.n=function(t){var r=t&&t.__esModule?function getDefault(){return t["default"]}:function getModuleExports(){return t};e.d(r,"a",r);return r}}()});